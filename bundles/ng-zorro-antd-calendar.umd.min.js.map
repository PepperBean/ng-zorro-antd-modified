{"version":3,"sources":["ng://ng-zorro-antd/calendar/nz-calendar-cells.ts","ng://ng-zorro-antd/calendar/nz-calendar-header.component.ts","ng://ng-zorro-antd/calendar/nz-calendar.component.ts","ng://ng-zorro-antd/calendar/nz-calendar.module.ts"],"names":["Directive","args","selector","exportAs","NzDateCellDirective","NzMonthCellDirective","NzDateFullCellDirective","NzMonthFullCellDirective","Object","defineProperty","NzCalendarHeaderComponent","prototype","this","_activeDate","value","setUpYears","activeDate","getFullYear","getMonth","fullscreen","i18n","getLocale","Calendar","year","month","ngOnInit","setUpMonths","updateYear","yearChange","emit","start","activeYear","yearOffset","end","yearTotal","years","i","push","label","months","dateInMonth","setMonth","monthText","dateHelper","format","Component","encapsulation","ViewEncapsulation","None","changeDetection","ChangeDetectionStrategy","OnPush","template","host","[style.display]","[class.ant-fullcalendar-header]","I18n","DateHelperService","Input","Output","mode","modeChange","EventEmitter","monthChange","Date","NzCalendarComponent","updateDate","dateCell","dateFullCell","monthCell","monthFullCell","coerceBooleanProperty","startOfWeek","startOfMonth","weekStartsOn","getFirstDayOfWeek","setUpDaysInWeek","setUpMonthsInYear","setUpDateMatrix","calculateCurrentDate","calculateActiveDate","calculateCurrentMonth","calculateActiveMonth","onModeChange","nzModeChange","nzPanelChange","date","onDateSelect","nzSelectChange","onYearSelect","setYear","onMonthSelect","writeValue","cdr","markForCheck","registerOnChange","fn","onChangeFn","registerOnTouched","onTouchFn","touched","dayChanged","isSameDay","monthChanged","isSameMonth","yearChanged","isSameYear","nzValueChange","daysInWeek","weekStart","addDays","title","relyOnDatePipe","monthsInYear","dateMatrix","monthStart","monthEnd","endOfMonth","weekDiff","differenceInCalendarWeeks","week","row","calendarStart","day","monthDiff","differenceInCalendarMonths","dateFormat","getLocaleData","rel","isThisMonth","currentDateRow","currentDate","currentDateCol","differenceInCalendarDays","activeDateRow","activeDateCol","isThisYear","yearStart","startOfYear","currentMonthRow","Math","floor","currentMonthCol","activeMonthRow","activeMonthCol","providers","provide","NG_VALUE_ACCESSOR","useExisting","forwardRef","multi","NzI18nService","ChangeDetectorRef","ContentChild","DateCell","read","TemplateRef","DateFullCell","MonthCell","MonthFullCell","HostBinding","nzMode","NgModule","declarations","exports","imports","CommonModule","FormsModule","NzI18nModule","NzRadioModule","NzSelectModule","NzCalendarModule"],"mappings":"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","sourcesContent":["/**\r\n * @license\r\n * Copyright Alibaba.com All Rights Reserved.\r\n *\r\n * Use of this source code is governed by an MIT-style license that can be\r\n * found in the LICENSE file at https://github.com/NG-ZORRO/ng-zorro-antd/blob/master/LICENSE\r\n */\r\n\r\nimport { Directive } from '@angular/core';\r\n\r\n@Directive({\r\n  selector: '[nzDateCell]',\r\n  exportAs: 'nzDateCell'\r\n})\r\nexport class NzDateCellDirective {}\r\n\r\n@Directive({\r\n  selector: '[nzMonthCell]',\r\n  exportAs: 'nzMonthCell'\r\n})\r\nexport class NzMonthCellDirective {}\r\n\r\n@Directive({\r\n  selector: '[nzDateFullCell]',\r\n  exportAs: 'nzDateFullCell'\r\n})\r\nexport class NzDateFullCellDirective {}\r\n\r\n@Directive({\r\n  selector: '[nzMonthFullCell]',\r\n  exportAs: 'nzMonthFullCell'\r\n})\r\nexport class NzMonthFullCellDirective {}\r\n","/**\r\n * @license\r\n * Copyright Alibaba.com All Rights Reserved.\r\n *\r\n * Use of this source code is governed by an MIT-style license that can be\r\n * found in the LICENSE file at https://github.com/NG-ZORRO/ng-zorro-antd/blob/master/LICENSE\r\n */\r\n\r\nimport {\r\n  ChangeDetectionStrategy,\r\n  Component,\r\n  EventEmitter,\r\n  Input,\r\n  OnInit,\r\n  Output,\r\n  ViewEncapsulation\r\n} from '@angular/core';\r\nimport setMonth from 'date-fns/set_month';\r\nimport { DateHelperService, NzI18nService as I18n } from 'ng-zorro-antd/i18n';\r\n\r\n@Component({\r\n  encapsulation: ViewEncapsulation.None,\r\n  changeDetection: ChangeDetectionStrategy.OnPush,\r\n  selector: 'nz-calendar-header',\r\n  exportAs: 'nzCalendarHeader',\r\n  templateUrl: './nz-calendar-header.component.html',\r\n  host: {\r\n    '[style.display]': `'block'`,\r\n    '[class.ant-fullcalendar-header]': `true`\r\n  }\r\n})\r\nexport class NzCalendarHeaderComponent implements OnInit {\r\n  @Input() mode: 'month' | 'year' = 'month';\r\n  @Output() readonly modeChange: EventEmitter<'month' | 'year'> = new EventEmitter();\r\n\r\n  @Input() fullscreen: boolean = true;\r\n\r\n  @Input()\r\n  set activeDate(value: Date) {\r\n    this._activeDate = value;\r\n    this.setUpYears();\r\n  }\r\n\r\n  get activeDate(): Date {\r\n    return this._activeDate;\r\n  }\r\n\r\n  @Output() readonly yearChange: EventEmitter<number> = new EventEmitter();\r\n  @Output() readonly monthChange: EventEmitter<number> = new EventEmitter();\r\n\r\n  _activeDate = new Date();\r\n  yearOffset: number = 10;\r\n  yearTotal: number = 20;\r\n  years: Array<{ label: string; value: number }>;\r\n  months: Array<{ label: string; value: number }>;\r\n\r\n  get activeYear(): number {\r\n    return this.activeDate.getFullYear();\r\n  }\r\n\r\n  get activeMonth(): number {\r\n    return this.activeDate.getMonth();\r\n  }\r\n\r\n  get size(): string {\r\n    return this.fullscreen ? 'default' : 'small';\r\n  }\r\n\r\n  get yearTypeText(): string {\r\n    return this.i18n.getLocale().Calendar.year;\r\n  }\r\n\r\n  get monthTypeText(): string {\r\n    return this.i18n.getLocale().Calendar.month;\r\n  }\r\n\r\n  constructor(private i18n: I18n, private dateHelper: DateHelperService) {}\r\n\r\n  ngOnInit(): void {\r\n    this.setUpYears();\r\n    this.setUpMonths();\r\n  }\r\n\r\n  updateYear(year: number): void {\r\n    this.yearChange.emit(year);\r\n    this.setUpYears(year);\r\n  }\r\n\r\n  private setUpYears(year?: number): void {\r\n    const start = (year || this.activeYear) - this.yearOffset;\r\n    const end = start + this.yearTotal;\r\n\r\n    this.years = [];\r\n    for (let i = start; i < end; i++) {\r\n      this.years.push({ label: `${i}`, value: i });\r\n    }\r\n  }\r\n\r\n  private setUpMonths(): void {\r\n    this.months = [];\r\n\r\n    for (let i = 0; i < 12; i++) {\r\n      const dateInMonth = setMonth(this.activeDate, i);\r\n      const monthText = this.dateHelper.format(dateInMonth, 'MMM');\r\n      this.months.push({ label: monthText, value: i });\r\n    }\r\n  }\r\n}\r\n","/**\r\n * @license\r\n * Copyright Alibaba.com All Rights Reserved.\r\n *\r\n * Use of this source code is governed by an MIT-style license that can be\r\n * found in the LICENSE file at https://github.com/NG-ZORRO/ng-zorro-antd/blob/master/LICENSE\r\n */\r\n\r\nimport { coerceBooleanProperty } from '@angular/cdk/coercion';\r\nimport {\r\n  forwardRef,\r\n  ChangeDetectionStrategy,\r\n  ChangeDetectorRef,\r\n  Component,\r\n  ContentChild,\r\n  EventEmitter,\r\n  HostBinding,\r\n  Input,\r\n  OnInit,\r\n  Output,\r\n  TemplateRef,\r\n  ViewEncapsulation\r\n} from '@angular/core';\r\nimport { ControlValueAccessor, NG_VALUE_ACCESSOR } from '@angular/forms';\r\nimport addDays from 'date-fns/add_days';\r\nimport differenceInCalendarDays from 'date-fns/difference_in_calendar_days';\r\nimport differenceInCalendarMonths from 'date-fns/difference_in_calendar_months';\r\nimport differenceInCalendarWeeks from 'date-fns/difference_in_calendar_weeks';\r\nimport endOfMonth from 'date-fns/end_of_month';\r\nimport isSameDay from 'date-fns/is_same_day';\r\nimport isSameMonth from 'date-fns/is_same_month';\r\nimport isSameYear from 'date-fns/is_same_year';\r\nimport isThisMonth from 'date-fns/is_this_month';\r\nimport isThisYear from 'date-fns/is_this_year';\r\nimport setMonth from 'date-fns/set_month';\r\nimport setYear from 'date-fns/set_year';\r\nimport startOfMonth from 'date-fns/start_of_month';\r\nimport startOfWeek from 'date-fns/start_of_week';\r\nimport startOfYear from 'date-fns/start_of_year';\r\n\r\nimport { DateHelperService, NzI18nService } from 'ng-zorro-antd/i18n';\r\n\r\nimport {\r\n  NzDateCellDirective as DateCell,\r\n  NzDateFullCellDirective as DateFullCell,\r\n  NzMonthCellDirective as MonthCell,\r\n  NzMonthFullCellDirective as MonthFullCell\r\n} from './nz-calendar-cells';\r\n\r\nexport type ModeType = 'month' | 'year';\r\n\r\n@Component({\r\n  encapsulation: ViewEncapsulation.None,\r\n  changeDetection: ChangeDetectionStrategy.OnPush,\r\n  selector: 'nz-calendar',\r\n  exportAs: 'nzCalendar',\r\n  templateUrl: './nz-calendar.component.html',\r\n  providers: [{ provide: NG_VALUE_ACCESSOR, useExisting: forwardRef(() => NzCalendarComponent), multi: true }]\r\n})\r\nexport class NzCalendarComponent implements ControlValueAccessor, OnInit {\r\n  @Input() nzMode: ModeType = 'month';\r\n  @Output() readonly nzModeChange: EventEmitter<ModeType> = new EventEmitter();\r\n  @Output() readonly nzPanelChange: EventEmitter<{ date: Date; mode: ModeType }> = new EventEmitter();\r\n\r\n  @Output() readonly nzSelectChange: EventEmitter<Date> = new EventEmitter();\r\n\r\n  @Input() set nzValue(value: Date) {\r\n    this.updateDate(value, false);\r\n  }\r\n  @Output() readonly nzValueChange: EventEmitter<Date> = new EventEmitter();\r\n\r\n  @Input()\r\n  set nzDateCell(value: TemplateRef<{ $implicit: Date }>) {\r\n    this.dateCell = value;\r\n  }\r\n\r\n  @Input()\r\n  set nzDateFullCell(value: TemplateRef<{ $implicit: Date }>) {\r\n    this.dateFullCell = value;\r\n  }\r\n\r\n  @Input()\r\n  set nzMonthCell(value: TemplateRef<{ $implicit: Date }>) {\r\n    this.monthCell = value;\r\n  }\r\n\r\n  @Input()\r\n  set nzMonthFullCell(value: TemplateRef<{ $implicit: Date }>) {\r\n    this.monthFullCell = value;\r\n  }\r\n\r\n  @Input()\r\n  set nzFullscreen(value: boolean) {\r\n    this.fullscreen = coerceBooleanProperty(value);\r\n  }\r\n  get nzFullscreen(): boolean {\r\n    return this.fullscreen;\r\n  }\r\n\r\n  @Input()\r\n  set nzCard(value: boolean) {\r\n    this.fullscreen = !coerceBooleanProperty(value);\r\n  }\r\n  get nzCard(): boolean {\r\n    return !this.fullscreen;\r\n  }\r\n\r\n  @ContentChild(DateCell, { read: TemplateRef })\r\n  set dateCellChild(value: TemplateRef<{ $implicit: Date }>) {\r\n    if (value) {\r\n      this.dateCell = value;\r\n    }\r\n  }\r\n\r\n  @ContentChild(DateFullCell, { read: TemplateRef })\r\n  set dateFullCellChild(value: TemplateRef<{ $implicit: Date }>) {\r\n    if (value) {\r\n      this.dateFullCell = value;\r\n    }\r\n  }\r\n\r\n  @ContentChild(MonthCell, { read: TemplateRef })\r\n  set monthCellChild(value: TemplateRef<{ $implicit: Date }>) {\r\n    if (value) {\r\n      this.monthCell = value;\r\n    }\r\n  }\r\n\r\n  @ContentChild(MonthFullCell, { read: TemplateRef })\r\n  set monthFullCellChild(value: TemplateRef<{ $implicit: Date }>) {\r\n    if (value) {\r\n      this.monthFullCell = value;\r\n    }\r\n  }\r\n\r\n  @HostBinding('class.ant-fullcalendar--fullscreen')\r\n  fullscreen = true;\r\n\r\n  daysInWeek: DayCellContext[] = [];\r\n  monthsInYear: MonthCellContext[] = [];\r\n  dateMatrix: DateCellContext[][] = [];\r\n  activeDate: Date = new Date();\r\n  currentDateRow: number = -1;\r\n  currentDateCol: number = -1;\r\n  activeDateRow: number = -1;\r\n  activeDateCol: number = -1;\r\n  currentMonthRow: number = -1;\r\n  currentMonthCol: number = -1;\r\n  activeMonthRow: number = -1;\r\n  activeMonthCol: number = -1;\r\n  dateCell: TemplateRef<{ $implicit: Date }> | null = null;\r\n  dateFullCell: TemplateRef<{ $implicit: Date }> | null = null;\r\n  monthCell: TemplateRef<{ $implicit: Date }> | null = null;\r\n  monthFullCell: TemplateRef<{ $implicit: Date }> | null = null;\r\n\r\n  private currentDate = new Date();\r\n  private onChangeFn: (date: Date) => void = () => {};\r\n  private onTouchFn: () => void = () => {};\r\n\r\n  private get calendarStart(): Date {\r\n    return startOfWeek(startOfMonth(this.activeDate), { weekStartsOn: this.dateHelper.getFirstDayOfWeek() });\r\n  }\r\n\r\n  constructor(private i18n: NzI18nService, private cdr: ChangeDetectorRef, private dateHelper: DateHelperService) {}\r\n\r\n  ngOnInit(): void {\r\n    this.setUpDaysInWeek();\r\n    this.setUpMonthsInYear();\r\n    this.setUpDateMatrix();\r\n    this.calculateCurrentDate();\r\n    this.calculateActiveDate();\r\n    this.calculateCurrentMonth();\r\n    this.calculateActiveMonth();\r\n  }\r\n\r\n  onModeChange(mode: ModeType): void {\r\n    this.nzModeChange.emit(mode);\r\n    this.nzPanelChange.emit({ date: this.activeDate, mode });\r\n  }\r\n\r\n  onDateSelect(date: Date): void {\r\n    this.updateDate(date);\r\n    this.nzSelectChange.emit(date);\r\n  }\r\n\r\n  onYearSelect(year: number): void {\r\n    const date = setYear(this.activeDate, year);\r\n    this.updateDate(date);\r\n    this.nzSelectChange.emit(date);\r\n  }\r\n\r\n  onMonthSelect(month: number): void {\r\n    const date = setMonth(this.activeDate, month);\r\n    this.updateDate(date);\r\n    this.nzSelectChange.emit(date);\r\n  }\r\n\r\n  writeValue(value: Date | null): void {\r\n    this.updateDate(value || new Date(), false);\r\n    this.cdr.markForCheck();\r\n  }\r\n\r\n  registerOnChange(fn: (date: Date) => void): void {\r\n    this.onChangeFn = fn;\r\n  }\r\n\r\n  registerOnTouched(fn: () => void): void {\r\n    this.onTouchFn = fn;\r\n  }\r\n\r\n  private updateDate(date: Date, touched: boolean = true): void {\r\n    const dayChanged = !isSameDay(date, this.activeDate);\r\n    const monthChanged = !isSameMonth(date, this.activeDate);\r\n    const yearChanged = !isSameYear(date, this.activeDate);\r\n\r\n    this.activeDate = date;\r\n\r\n    if (dayChanged) {\r\n      this.calculateActiveDate();\r\n    }\r\n    if (monthChanged) {\r\n      this.setUpDateMatrix();\r\n      this.calculateCurrentDate();\r\n      this.calculateActiveMonth();\r\n    }\r\n    if (yearChanged) {\r\n      this.calculateCurrentMonth();\r\n    }\r\n\r\n    if (touched) {\r\n      this.onChangeFn(date);\r\n      this.onTouchFn();\r\n      this.nzValueChange.emit(date);\r\n    }\r\n  }\r\n\r\n  private setUpDaysInWeek(): void {\r\n    this.daysInWeek = [];\r\n    const weekStart = startOfWeek(this.activeDate, { weekStartsOn: this.dateHelper.getFirstDayOfWeek() });\r\n    for (let i = 0; i < 7; i++) {\r\n      const date = addDays(weekStart, i);\r\n      const title = this.dateHelper.format(date, this.dateHelper.relyOnDatePipe ? 'E' : 'ddd');\r\n      const label = this.dateHelper.format(date, this.dateHelper.relyOnDatePipe ? 'EEEEEE' : 'dd');\r\n      this.daysInWeek.push({ title, label });\r\n    }\r\n  }\r\n\r\n  private setUpMonthsInYear(): void {\r\n    this.monthsInYear = [];\r\n    for (let i = 0; i < 12; i++) {\r\n      const date = setMonth(this.activeDate, i);\r\n      const title = this.dateHelper.format(date, 'MMM');\r\n      const label = this.dateHelper.format(date, 'MMM');\r\n      const start = startOfMonth(date);\r\n      this.monthsInYear.push({ title, label, start });\r\n    }\r\n  }\r\n\r\n  private setUpDateMatrix(): void {\r\n    this.dateMatrix = [];\r\n    const monthStart = startOfMonth(this.activeDate);\r\n    const monthEnd = endOfMonth(this.activeDate);\r\n    const weekDiff =\r\n      differenceInCalendarWeeks(monthEnd, monthStart, { weekStartsOn: this.dateHelper.getFirstDayOfWeek() }) + 2;\r\n\r\n    for (let week = 0; week < weekDiff; week++) {\r\n      const row: DateCellContext[] = [];\r\n      const weekStart = addDays(this.calendarStart, week * 7);\r\n\r\n      for (let day = 0; day < 7; day++) {\r\n        const date = addDays(weekStart, day);\r\n        const monthDiff = differenceInCalendarMonths(date, this.activeDate);\r\n        const dateFormat = this.dateHelper.relyOnDatePipe\r\n          ? 'longDate'\r\n          : this.i18n.getLocaleData('DatePicker.lang.dateFormat', 'YYYY-MM-DD');\r\n        const title = this.dateHelper.format(date, dateFormat);\r\n        const label = this.dateHelper.format(date, this.dateHelper.relyOnDatePipe ? 'dd' : 'DD');\r\n        const rel = monthDiff === 0 ? 'current' : monthDiff < 0 ? 'last' : 'next';\r\n        row.push({ title, label, rel, value: date });\r\n      }\r\n      this.dateMatrix.push(row);\r\n    }\r\n  }\r\n\r\n  private calculateCurrentDate(): void {\r\n    if (isThisMonth(this.activeDate)) {\r\n      this.currentDateRow = differenceInCalendarWeeks(this.currentDate, this.calendarStart, {\r\n        weekStartsOn: this.dateHelper.getFirstDayOfWeek()\r\n      });\r\n      this.currentDateCol = differenceInCalendarDays(\r\n        this.currentDate,\r\n        addDays(this.calendarStart, this.currentDateRow * 7)\r\n      );\r\n    } else {\r\n      this.currentDateRow = -1;\r\n      this.currentDateCol = -1;\r\n    }\r\n  }\r\n\r\n  private calculateActiveDate(): void {\r\n    this.activeDateRow = differenceInCalendarWeeks(this.activeDate, this.calendarStart, {\r\n      weekStartsOn: this.dateHelper.getFirstDayOfWeek()\r\n    });\r\n    this.activeDateCol = differenceInCalendarDays(this.activeDate, addDays(this.calendarStart, this.activeDateRow * 7));\r\n  }\r\n\r\n  private calculateCurrentMonth(): void {\r\n    if (isThisYear(this.activeDate)) {\r\n      const yearStart = startOfYear(this.currentDate);\r\n      const monthDiff = differenceInCalendarMonths(this.currentDate, yearStart);\r\n      this.currentMonthRow = Math.floor(monthDiff / 3);\r\n      this.currentMonthCol = monthDiff % 3;\r\n    } else {\r\n      this.currentMonthRow = -1;\r\n      this.currentMonthCol = -1;\r\n    }\r\n  }\r\n\r\n  private calculateActiveMonth(): void {\r\n    this.activeMonthRow = Math.floor(this.activeDate.getMonth() / 3);\r\n    this.activeMonthCol = this.activeDate.getMonth() % 3;\r\n  }\r\n}\r\n\r\nexport interface DayCellContext {\r\n  title: string;\r\n  label: string;\r\n}\r\n\r\nexport interface MonthCellContext {\r\n  title: string;\r\n  label: string;\r\n  start: Date;\r\n}\r\n\r\nexport interface DateCellContext {\r\n  title: string;\r\n  label: string;\r\n  rel: 'last' | 'current' | 'next';\r\n  value: Date;\r\n}\r\n","/**\r\n * @license\r\n * Copyright Alibaba.com All Rights Reserved.\r\n *\r\n * Use of this source code is governed by an MIT-style license that can be\r\n * found in the LICENSE file at https://github.com/NG-ZORRO/ng-zorro-antd/blob/master/LICENSE\r\n */\r\n\r\nimport { CommonModule } from '@angular/common';\r\nimport { NgModule } from '@angular/core';\r\nimport { FormsModule } from '@angular/forms';\r\n\r\nimport { NzI18nModule } from 'ng-zorro-antd/i18n';\r\nimport { NzRadioModule } from 'ng-zorro-antd/radio';\r\nimport { NzSelectModule } from 'ng-zorro-antd/select';\r\n\r\nimport {\r\n  NzDateCellDirective,\r\n  NzDateFullCellDirective,\r\n  NzMonthCellDirective,\r\n  NzMonthFullCellDirective\r\n} from './nz-calendar-cells';\r\nimport { NzCalendarHeaderComponent } from './nz-calendar-header.component';\r\nimport { NzCalendarComponent } from './nz-calendar.component';\r\n\r\n@NgModule({\r\n  declarations: [\r\n    NzCalendarHeaderComponent,\r\n    NzCalendarComponent,\r\n    NzDateCellDirective,\r\n    NzDateFullCellDirective,\r\n    NzMonthCellDirective,\r\n    NzMonthFullCellDirective\r\n  ],\r\n  exports: [\r\n    NzCalendarComponent,\r\n    NzDateCellDirective,\r\n    NzDateFullCellDirective,\r\n    NzMonthCellDirective,\r\n    NzMonthFullCellDirective\r\n  ],\r\n  imports: [CommonModule, FormsModule, NzI18nModule, NzRadioModule, NzSelectModule]\r\n})\r\nexport class NzCalendarModule {}\r\n"]}